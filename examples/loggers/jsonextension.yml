logging:
  version: 1
  disable_existing_loggers: true
  formatters:
    standard:
      format: '%(json)s'
  handlers:
    console:
      level: INFO
      formatter: standard
      class: logging.StreamHandler
      stream: 'ext://sys.stderr'
  loggers:
    "waitress_raw":
      handlers: [console]
      level: INFO
      propagate: false

waitress:
  connection_limit: 100
  threads: 25

extension:
  source: |
    import json

    def process(log):
        log["request"] = repr(log["request"])
        log["body"] = repr(log["body"])
        log["json"] = json.dumps(log)
        return log